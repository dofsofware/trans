import React, { createContext, useContext, useState, ReactNode } from 'react';

type Language = 'en' | 'fr';

interface LanguageContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string, params?: Record<string, any>) => string;
}

const translations = {
  en: {
    dashboard: 'Dashboard',
    shipments: 'My Shipments',
    documents: 'Documents',
    messages: 'Messages',
    payments: 'Payments',
    invoices: 'Invoices',
    profile: 'Profile',
    settings: 'Settings',
    signOut: 'Sign out',
    welcome: 'Welcome back',
    notifications: 'Notifications',
    support: 'Need assistance?',
    contactSupport: 'Contact Support',
    inTransit: 'In Transit',
    inWarehouse: 'In Warehouse',
    totalShipments: 'Total Shipments',
    issues: 'Issues',
    activeShipments: 'Active Shipments',
    viewAll: 'View all',
    recentActivity: 'Recent Activity',
    noActiveShipments: 'You don\'t have any active shipments at the moment.',
    updatedOn: 'Updated on',
    from: 'From',
    to: 'To',
    weight: 'Weight',
    volume: 'Volume',
    status: 'Status',
    origin: 'Origin',
    destination: 'Destination',
    description: 'Description',
    estimatedDelivery: 'Estimated Delivery',
    pending: 'Pending',
    draft: 'Draft',
    processing: 'Processing',
    customs: 'Customs Clearance',
    delivered: 'Delivered',
    issue: 'Issue',
    statsInTransit: 'In Transit',
    statsInWarehouse: 'In Warehouse',
    statsTotalShipments: 'Total Shipments',
    statsIssues: 'Issues',
    hereIsOverview: 'Here\'s an overview of your shipments',
    in_transit:'In Transit',
    warehouse: 'In Warehouse',
    all: 'All',
    created_at: 'Created on',
    shipment_timeLine: 'Shipment Timeline',
    in_customs_clearance: 'In Customs Clearance',
    shipment_created: 'Shipment Created',
    processing_started: 'Processing Started',
    arrived_at_warehouse: 'Arrived at Warehouse',
    delivered_successfully: 'Delivered Successfully',
    issue_reported: 'Issue Reported',
    my_shipments: 'My Shipments',
    search_shipments: 'Search shipments...',
    filter_by_status: 'Filter by Status',
    track_the_progress: 'Track the progress of your shipment',
    download: 'Download',
    no_documents_yet: 'No documents available yet.',
    quick_actions: 'Quick Actions',
    contact_agent: 'Contact Agent',
    notifications_description: 'Stay updated with your shipment status and important alerts',
    all_notifications: 'All Notifications',
    unread_count: (params: { count: number }) => `You have ${params.count} unread notifications`,
    mark_all_as_read: 'Mark all as read',
    no_notifications: 'No notifications',
    no_notifications_description: 'You\'re all caught up! No new notifications at the moment.',
    view_all_notifications: 'View all notifications',
    view_profile_analytics: 'View your profile and shipping analytics',
    member_since: 'Member since',
    completion_rate: 'Completion Rate',
    active_shipments: 'Active Shipments',
    completed: 'Completed',
    monthly_shipments: 'Monthly Shipments',
    shipment_status_distribution: 'Shipment Status Distribution',
    manage_account_preferences: 'Manage your account preferences',
    change_avatar: 'Change avatar',
    name: 'Name',
    email: 'Email',
    preferences: 'Preferences',
    language_preference: 'Language',
    email_notifications: 'Email notifications',
    receive_notifications: 'Receive notifications about your shipments',
    security: 'Security',
    change_password: 'Change password',
    cancel: 'Cancel',
    save_changes: 'Save changes',
    tracking_number: 'Tracking #',
    // Invoice translations
    my_invoices: 'My Invoices',
    invoice_number: 'Invoice Number',
    amount: 'Amount',
    due_date: 'Due Date',
    payment_status: 'Payment Status',
    paid: 'Paid',
    unpaid: 'Unpaid',
    overdue: 'Overdue',
    search_invoices: 'Search invoices...',
    filter_by_payment_status: 'Filter by Payment Status',
    total_paid: 'Total Paid',
    total_unpaid: 'Total Unpaid',
    total_overdue: 'Total Overdue',
    pay_now: 'Pay Now',
    view_invoice: 'View Invoice',
    download_invoice: 'Download Invoice',
    invoice_date: 'Invoice Date',
    payment_due: 'Payment Due',
    payment_received: 'Payment Received',
    invoice_details: 'Invoice Details',
  },
  fr: {
    dashboard: 'Tableau de bord',
    shipments: 'Mes expéditions',
    documents: 'Documents',
    messages: 'Messages',
    payments: 'Paiements',
    invoices: 'Factures',
    profile: 'Profil',
    settings: 'Paramètres',
    signOut: 'Déconnexion',
    welcome: 'Bienvenue',
    notifications: 'Notifications',
    support: 'Besoin d\'aide ?',
    contactSupport: 'Contacter le support',
    inTransit: 'En transit',
    inWarehouse: 'En entrepôt',
    totalShipments: 'Total des expéditions',
    issues: 'Problèmes',
    activeShipments: 'Expéditions actives',
    viewAll: 'Voir tout',
    recentActivity: 'Activité récente',
    noActiveShipments: 'Vous n\'avez aucune expédition active en ce moment.',
    updatedOn: 'Mis à jour le',
    from: 'De',
    to: 'Vers',
    weight: 'Poids',
    volume: 'Volume',
    status: 'Statut',
    origin: 'Origine',
    destination: 'Destination',
    description: 'Description',
    estimatedDelivery: 'Livraison estimée',
    pending: 'En attente',
    draft: 'Brouillon',
    processing: 'En traitement',
    customs: 'Dédouanement',
    delivered: 'Livré',
    issue: 'Problème',
    statsInTransit: 'En Transit',
    statsInWarehouse: 'En Entrepôt',
    statsTotalShipments: 'Total des Expéditions',
    statsIssues: 'Problèmes',
    hereIsOverview: 'Voici un aperçu de vos expéditions',
    in_transit:'En Transit',
    warehouse: 'En Entrepôt',
    all: 'Tout',
    created_at: 'Créé le',
    shipment_timeLine: 'Calendrier d\'expédition',
    in_customs_clearance: 'En dédouanement',
    shipment_created: 'Expédition créée',
    processing_started: 'Traitement démarré',
    arrived_at_warehouse: 'Arrivé à l\'entrepôt',
    delivered_successfully: 'Livré avec succès',
    issue_reported: 'Problème signalé',
    my_shipments: 'Mes Expéditions',
    search_shipments: 'Rechercher expédition...',
    filter_by_status: 'Filtre par statut',
    track_the_progress: 'Suivez la progression de votre envoi',
    download: 'Télécharger',
    no_documents_yet: 'Aucun document disponible pour le moment.',
    quick_actions: 'Actions rapides',
    contact_agent: 'Contacter un agent',
    notifications_description: 'Restez informé de l\'état de vos expéditions et des alertes importantes',
    all_notifications: 'Toutes les notifications',
    unread_count: (params: { count: number }) => `Vous avez ${params.count} notifications non lues`,
    mark_all_as_read: 'Tout marquer comme lu',
    no_notifications: 'Aucune notification',
    no_notifications_description: 'Vous êtes à jour ! Aucune nouvelle notification pour le moment.',
    view_all_notifications: 'Voir toutes les notifications',
    view_profile_analytics: 'Consultez votre profil et vos analyses d\'expédition',
    member_since: 'Membre depuis',
    completion_rate: 'Taux de réussite',
    active_shipments: 'Expéditions actives',
    completed: 'Terminé',
    monthly_shipments: 'Expéditions mensuelles',
    shipment_status_distribution: 'Distribution des statuts d\'expédition',
    manage_account_preferences: 'Gérez vos préférences de compte',
    change_avatar: 'Changer l\'avatar',
    name: 'Nom',
    email: 'Email',
    preferences: 'Préférences',
    language_preference: 'Langue',
    email_notifications: 'Notifications par email',
    receive_notifications: 'Recevoir des notifications concernant vos expéditions',
    security: 'Sécurité',
    change_password: 'Changer le mot de passe',
    cancel: 'Annuler',
    save_changes: 'Enregistrer les modifications',
    tracking_number: 'N° de suivi',
    // Invoice translations
    my_invoices: 'Mes Factures',
    invoice_number: 'Numéro de facture',
    amount: 'Montant',
    due_date: 'Date d\'échéance',
    payment_status: 'Statut de paiement',
    paid: 'Payée',
    unpaid: 'Non payée',
    overdue: 'En retard',
    search_invoices: 'Rechercher des factures...',
    filter_by_payment_status: 'Filtrer par statut de paiement',
    total_paid: 'Total payé',
    total_unpaid: 'Total non payé',
    total_overdue: 'Total en retard',
    pay_now: 'Payer maintenant',
    view_invoice: 'Voir la facture',
    download_invoice: 'Télécharger la facture',
    invoice_date: 'Date de facturation',
    payment_due: 'Paiement dû',
    payment_received: 'Paiement reçu',
    invoice_details: 'Détails de la facture',
  },
};

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

export const useLanguage = () => {
  const context = useContext(LanguageContext);
  if (context === undefined) {
    throw new Error('useLanguage must be used within a LanguageProvider');
  }
  return context;
};

export const LanguageProvider: React.FC<{ children: ReactNode }> = ({ children }) => {
  const [language, setLanguage] = useState<Language>('fr');

  const t = (key: string, params?: Record<string, any>): string => {
    const translation = translations[language][key as keyof typeof translations['fr']];
    if (typeof translation === 'function' && params) {
      return translation(params);
    }
    return translation || key;
  };

  return (
    <LanguageContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  );
};